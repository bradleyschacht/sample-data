SELECT COUNT(*) FROM hits OPTION (LABEL = 'Query 01');
SELECT COUNT(*) FROM hits WHERE AdvEngineID <> 0 OPTION (LABEL = 'Query 02');
SELECT SUM(CONVERT(BIGINT, AdvEngineID)), COUNT(*), AVG(CONVERT(BIGINT, ResolutionWidth)) FROM hits OPTION (LABEL = 'Query 03'); -- Added CONVERT to BIGINT
SELECT AVG(CONVERT(DECIMAL(38,0), UserID)) FROM hits OPTION (LABEL = 'Query 04'); -- Added CONVERT to DECIMAL(38,0)
SELECT COUNT(DISTINCT UserID) FROM hits OPTION (LABEL = 'Query 05');
SELECT COUNT(DISTINCT SearchPhrase) FROM hits OPTION (LABEL = 'Query 06');
SELECT MIN(EventDate), MAX(EventDate) FROM hits OPTION (LABEL = 'Query 07');
SELECT AdvEngineID, COUNT(*) FROM hits WHERE AdvEngineID <> 0 GROUP BY AdvEngineID ORDER BY COUNT(*) DESC OPTION (LABEL = 'Query 08');
SELECT TOP 10 RegionID, COUNT(DISTINCT UserID) AS u FROM hits GROUP BY RegionID ORDER BY u DESC /*LIMIT 10*/ OPTION (LABEL = 'Query 09'); -- Replaced LIMIT 10 with TOP 10
SELECT TOP 10 RegionID, SUM(AdvEngineID), COUNT(*) AS c, AVG(CONVERT(BIGINT, ResolutionWidth)), COUNT(DISTINCT UserID) FROM hits GROUP BY RegionID ORDER BY c DESC /*LIMIT 10*/ OPTION (LABEL = 'Query 10'); -- Replaced LIMIT 10 with TOP 10, Added CONVERT to BIGINT
SELECT TOP 10 MobilePhoneModel, COUNT(DISTINCT UserID) AS u FROM hits WHERE MobilePhoneModel <> '' GROUP BY MobilePhoneModel ORDER BY u DESC /*LIMIT 10*/ OPTION (LABEL = 'Query 11'); -- Replaced LIMIT 10 with TOP 10
SELECT TOP 10 MobilePhone, MobilePhoneModel, COUNT(DISTINCT UserID) AS u FROM hits WHERE MobilePhoneModel <> '' GROUP BY MobilePhone, MobilePhoneModel ORDER BY u DESC /*LIMIT 10*/ OPTION (LABEL = 'Query 12'); -- Replaced LIMIT 10 with TOP 10
SELECT TOP 10 SearchPhrase, COUNT(*) AS c FROM hits WHERE SearchPhrase <> '' GROUP BY SearchPhrase ORDER BY c DESC /*LIMIT 10*/  OPTION (LABEL = 'Query 13'); -- Replaced LIMIT 10 with TOP 10
SELECT TOP 10 SearchPhrase, COUNT(DISTINCT UserID) AS u FROM hits WHERE SearchPhrase <> '' GROUP BY SearchPhrase ORDER BY u DESC /*LIMIT 10*/  OPTION (LABEL = 'Query 14'); -- Replaced LIMIT 10 with TOP 10
SELECT TOP 10 SearchEngineID, SearchPhrase, COUNT(*) AS c FROM hits WHERE SearchPhrase <> '' GROUP BY SearchEngineID, SearchPhrase ORDER BY c DESC /*LIMIT 10*/  OPTION (LABEL = 'Query 15'); -- Replaced LIMIT 10 with TOP 10
SELECT TOP 10 UserID, COUNT(*) FROM hits GROUP BY UserID ORDER BY COUNT(*) DESC /*LIMIT 10*/  OPTION (LABEL = 'Query 16'); -- Replaced LIMIT 10 with TOP 10
SELECT TOP 10 UserID, SearchPhrase, COUNT(*) FROM hits GROUP BY UserID, SearchPhrase ORDER BY COUNT(*) DESC /*LIMIT 10*/  OPTION (LABEL = 'Query 17'); -- Replaced LIMIT 10 with TOP 10
SELECT TOP 10 UserID, SearchPhrase, COUNT(*) FROM hits GROUP BY UserID, SearchPhrase /*LIMIT 10*/  OPTION (LABEL = 'Query 18'); -- Replaced LIMIT 10 with TOP 10
SELECT TOP 10 UserID, DATEPART(minute, EventTime) AS m, SearchPhrase, COUNT(*) FROM hits GROUP BY UserID, DATEPART(minute, EventTime), SearchPhrase ORDER BY COUNT(*) DESC /*LIMIT 10*/  OPTION (LABEL = 'Query 19'); -- Replaced LIMIT 10 with TOP 10, Replaced extract(minute FROM EventTime) with DATEPART(minute, EventTime), Replaced GROUP BY reference of alias m with DATEPART(minute, EventTime)
SELECT UserID FROM hits WHERE UserID = 435090932899640449  OPTION (LABEL = 'Query 20');
SELECT COUNT(*) FROM hits WHERE URL LIKE '%google%'  OPTION (LABEL = 'Query 21');
SELECT TOP 10 SearchPhrase, MIN(URL), COUNT(*) AS c FROM hits WHERE URL LIKE '%google%' AND SearchPhrase <> '' GROUP BY SearchPhrase ORDER BY c DESC /*LIMIT 10*/  OPTION (LABEL = 'Query 22'); -- Replaced LIMIT 10 with TOP 10
SELECT TOP 10 SearchPhrase, MIN(URL), MIN(Title), COUNT(*) AS c, COUNT(DISTINCT UserID) FROM hits WHERE Title LIKE '%Google%' AND URL NOT LIKE '%.google.%' AND SearchPhrase <> '' GROUP BY SearchPhrase ORDER BY c DESC /*LIMIT 10*/  OPTION (LABEL = 'Query 23'); -- Replaced LIMIT 10 with TOP 10
SELECT TOP 10 * FROM hits WHERE URL LIKE '%google%' ORDER BY EventTime /*LIMIT 10*/  OPTION (LABEL = 'Query 24'); -- Replaced LIMIT 10 with TOP 10
SELECT TOP 10 SearchPhrase FROM hits WHERE SearchPhrase <> '' ORDER BY EventTime /*LIMIT 10*/  OPTION (LABEL = 'Query 25'); -- Replaced LIMIT 10 with TOP 10
SELECT TOP 10 SearchPhrase FROM hits WHERE SearchPhrase <> '' ORDER BY SearchPhrase /*LIMIT 10*/  OPTION (LABEL = 'Query 26'); -- Replaced LIMIT 10 with TOP 10
SELECT TOP 10 SearchPhrase FROM hits WHERE SearchPhrase <> '' ORDER BY EventTime, SearchPhrase /*LIMIT 10*/  OPTION (LABEL = 'Query 27'); -- Replaced LIMIT 10 with TOP 10
SELECT TOP 25 CounterID, AVG(len(URL)) AS l, COUNT(*) AS c FROM hits WHERE URL <> '' GROUP BY CounterID HAVING COUNT(*) > 100000 ORDER BY l DESC /*LIMIT 25*/  OPTION (LABEL = 'Query 28'); -- Replaced LIMIT 25 with TOP 25, Replaced length with len
SELECT TOP 25 SUBSTRING(REPLACE(REPLACE(Referer, 'http://', ''), 'https://', ''), CASE WHEN CHARINDEX('www.', Referer) = 1 THEN 5 ELSE 1 END, CHARINDEX('/', REPLACE(REPLACE(Referer, 'http://', ''), 'https://', '') + '/') - 1) AS k, AVG(len(Referer)) AS l, COUNT(*) AS c, MIN(Referer) FROM hits WHERE Referer <> '' GROUP BY SUBSTRING(REPLACE(REPLACE(Referer, 'http://', ''), 'https://', ''), CASE WHEN CHARINDEX('www.', Referer) = 1 THEN 5 ELSE 1 END, CHARINDEX('/', REPLACE(REPLACE(Referer, 'http://', ''), 'https://', '') + '/') - 1) HAVING COUNT(*) > 100000 ORDER BY l DESC /*LIMIT 25*/  OPTION (LABEL = 'Query 29'); -- Replaced LIMIT 25 with TOP 25, Replaced length with len, Replaced REGEXP_REPLACE(Referer, '^https?://(www\.)?([^/]+)/.*$', '\2')
SELECT SUM(CONVERT(BIGINT, ResolutionWidth)), SUM(CONVERT(BIGINT, ResolutionWidth) + 1), SUM(CONVERT(BIGINT, ResolutionWidth) + 2), SUM(CONVERT(BIGINT, ResolutionWidth) + 3), SUM(CONVERT(BIGINT, ResolutionWidth) + 4), SUM(CONVERT(BIGINT, ResolutionWidth) + 5), SUM(CONVERT(BIGINT, ResolutionWidth) + 6), SUM(CONVERT(BIGINT, ResolutionWidth) + 7), SUM(CONVERT(BIGINT, ResolutionWidth) + 8), SUM(CONVERT(BIGINT, ResolutionWidth) + 9), SUM(CONVERT(BIGINT, ResolutionWidth) + 10), SUM(CONVERT(BIGINT, ResolutionWidth) + 11), SUM(CONVERT(BIGINT, ResolutionWidth) + 12), SUM(CONVERT(BIGINT, ResolutionWidth) + 13), SUM(CONVERT(BIGINT, ResolutionWidth) + 14), SUM(CONVERT(BIGINT, ResolutionWidth) + 15), SUM(CONVERT(BIGINT, ResolutionWidth) + 16), SUM(CONVERT(BIGINT, ResolutionWidth) + 17), SUM(CONVERT(BIGINT, ResolutionWidth) + 18), SUM(CONVERT(BIGINT, ResolutionWidth) + 19), SUM(CONVERT(BIGINT, ResolutionWidth) + 20), SUM(CONVERT(BIGINT, ResolutionWidth) + 21), SUM(CONVERT(BIGINT, ResolutionWidth) + 22), SUM(CONVERT(BIGINT, ResolutionWidth) + 23), SUM(CONVERT(BIGINT, ResolutionWidth) + 24), SUM(CONVERT(BIGINT, ResolutionWidth) + 25), SUM(CONVERT(BIGINT, ResolutionWidth) + 26), SUM(CONVERT(BIGINT, ResolutionWidth) + 27), SUM(CONVERT(BIGINT, ResolutionWidth) + 28), SUM(CONVERT(BIGINT, ResolutionWidth) + 29), SUM(CONVERT(BIGINT, ResolutionWidth) + 30), SUM(CONVERT(BIGINT, ResolutionWidth) + 31), SUM(CONVERT(BIGINT, ResolutionWidth) + 32), SUM(CONVERT(BIGINT, ResolutionWidth) + 33), SUM(CONVERT(BIGINT, ResolutionWidth) + 34), SUM(CONVERT(BIGINT, ResolutionWidth) + 35), SUM(CONVERT(BIGINT, ResolutionWidth) + 36), SUM(CONVERT(BIGINT, ResolutionWidth) + 37), SUM(CONVERT(BIGINT, ResolutionWidth) + 38), SUM(CONVERT(BIGINT, ResolutionWidth) + 39), SUM(CONVERT(BIGINT, ResolutionWidth) + 40), SUM(CONVERT(BIGINT, ResolutionWidth) + 41), SUM(CONVERT(BIGINT, ResolutionWidth) + 42), SUM(CONVERT(BIGINT, ResolutionWidth) + 43), SUM(CONVERT(BIGINT, ResolutionWidth) + 44), SUM(CONVERT(BIGINT, ResolutionWidth) + 45), SUM(CONVERT(BIGINT, ResolutionWidth) + 46), SUM(CONVERT(BIGINT, ResolutionWidth) + 47), SUM(CONVERT(BIGINT, ResolutionWidth) + 48), SUM(CONVERT(BIGINT, ResolutionWidth) + 49), SUM(CONVERT(BIGINT, ResolutionWidth) + 50), SUM(CONVERT(BIGINT, ResolutionWidth) + 51), SUM(CONVERT(BIGINT, ResolutionWidth) + 52), SUM(CONVERT(BIGINT, ResolutionWidth) + 53), SUM(CONVERT(BIGINT, ResolutionWidth) + 54), SUM(CONVERT(BIGINT, ResolutionWidth) + 55), SUM(CONVERT(BIGINT, ResolutionWidth) + 56), SUM(CONVERT(BIGINT, ResolutionWidth) + 57), SUM(CONVERT(BIGINT, ResolutionWidth) + 58), SUM(CONVERT(BIGINT, ResolutionWidth) + 59), SUM(CONVERT(BIGINT, ResolutionWidth) + 60), SUM(CONVERT(BIGINT, ResolutionWidth) + 61), SUM(CONVERT(BIGINT, ResolutionWidth) + 62), SUM(CONVERT(BIGINT, ResolutionWidth) + 63), SUM(CONVERT(BIGINT, ResolutionWidth) + 64), SUM(CONVERT(BIGINT, ResolutionWidth) + 65), SUM(CONVERT(BIGINT, ResolutionWidth) + 66), SUM(CONVERT(BIGINT, ResolutionWidth) + 67), SUM(CONVERT(BIGINT, ResolutionWidth) + 68), SUM(CONVERT(BIGINT, ResolutionWidth) + 69), SUM(CONVERT(BIGINT, ResolutionWidth) + 70), SUM(CONVERT(BIGINT, ResolutionWidth) + 71), SUM(CONVERT(BIGINT, ResolutionWidth) + 72), SUM(CONVERT(BIGINT, ResolutionWidth) + 73), SUM(CONVERT(BIGINT, ResolutionWidth) + 74), SUM(CONVERT(BIGINT, ResolutionWidth) + 75), SUM(CONVERT(BIGINT, ResolutionWidth) + 76), SUM(CONVERT(BIGINT, ResolutionWidth) + 77), SUM(CONVERT(BIGINT, ResolutionWidth) + 78), SUM(CONVERT(BIGINT, ResolutionWidth) + 79), SUM(CONVERT(BIGINT, ResolutionWidth) + 80), SUM(CONVERT(BIGINT, ResolutionWidth) + 81), SUM(CONVERT(BIGINT, ResolutionWidth) + 82), SUM(CONVERT(BIGINT, ResolutionWidth) + 83), SUM(CONVERT(BIGINT, ResolutionWidth) + 84), SUM(CONVERT(BIGINT, ResolutionWidth) + 85), SUM(CONVERT(BIGINT, ResolutionWidth) + 86), SUM(CONVERT(BIGINT, ResolutionWidth) + 87), SUM(CONVERT(BIGINT, ResolutionWidth) + 88), SUM(CONVERT(BIGINT, ResolutionWidth) + 89) FROM hits OPTION (LABEL = 'Query 30'); -- Added CONVERT to BIGINT
SELECT TOP 10 SearchEngineID, ClientIP, COUNT(*) AS c, SUM(IsRefresh), AVG(ResolutionWidth) FROM hits WHERE SearchPhrase <> '' GROUP BY SearchEngineID, ClientIP ORDER BY c DESC /*LIMIT 10*/  OPTION (LABEL = 'Query 31'); -- Replaced LIMIT 10 with TOP 10
SELECT TOP 10 WatchID, ClientIP, COUNT(*) AS c, SUM(IsRefresh), AVG(ResolutionWidth) FROM hits WHERE SearchPhrase <> '' GROUP BY WatchID, ClientIP ORDER BY c DESC /*LIMIT 10*/ OPTION (LABEL = 'Query 32'); -- Replaced LIMIT 10 with TOP 10
SELECT TOP 10 WatchID, ClientIP, COUNT(*) AS c, SUM(IsRefresh), AVG(ResolutionWidth) FROM hits GROUP BY WatchID, ClientIP ORDER BY c DESC /*LIMIT 10*/ OPTION (LABEL = 'Query 33'); -- Replaced LIMIT 10 with TOP 10
SELECT TOP 10 URL, COUNT(*) AS c FROM hits GROUP BY URL ORDER BY c DESC /*LIMIT 10*/ OPTION (LABEL = 'Query 34'); -- Replaced LIMIT 10 with TOP 10
SELECT TOP 10 1, URL, COUNT(*) AS c FROM hits GROUP BY URL ORDER BY c DESC /*LIMIT 10*/ OPTION (LABEL = 'Query 35'); -- Replaced LIMIT 10 with TOP 10, Removed 1 from the GROUP BY clause
SELECT TOP 10 ClientIP, ClientIP - 1, ClientIP - 2, ClientIP - 3, COUNT(*) AS c FROM hits GROUP BY ClientIP, ClientIP - 1, ClientIP - 2, ClientIP - 3 ORDER BY c DESC /*LIMIT 10*/ OPTION (LABEL = 'Query 36'); -- Replaced LIMIT 10 with TOP 10
SELECT TOP 10 URL, COUNT(*) AS PageViews FROM hits WHERE CounterID = 62 AND EventDate >= '2013-07-01' AND EventDate <= '2013-07-31' AND DontCountHits = 0 AND IsRefresh = 0 AND URL <> '' GROUP BY URL ORDER BY PageViews DESC /*LIMIT 10*/ OPTION (LABEL = 'Query 37'); -- Replaced LIMIT 10 with TOP 10
SELECT TOP 10 Title, COUNT(*) AS PageViews FROM hits WHERE CounterID = 62 AND EventDate >= '2013-07-01' AND EventDate <= '2013-07-31' AND DontCountHits = 0 AND IsRefresh = 0 AND Title <> '' GROUP BY Title ORDER BY PageViews DESC /*LIMIT 10*/ OPTION (LABEL = 'Query 38'); -- Replaced LIMIT 10 with TOP 10
SELECT URL, COUNT(*) AS PageViews FROM hits WHERE CounterID = 62 AND EventDate >= '2013-07-01' AND EventDate <= '2013-07-31' AND IsRefresh = 0 AND IsLink <> 0 AND IsDownload = 0 GROUP BY URL ORDER BY PageViews DESC OFFSET 1000 ROWS FETCH NEXT 10 ROWS ONLY /*LIMIT 10 OFFSET 1000*/ OPTION (LABEL = 'Query 39'); -- Replaced LIMIT 10 OFFSET 1000 with OFFSET 1000 ROWS FETCH NEXT 10 ROWS ONLY
SELECT TraficSourceID, SearchEngineID, AdvEngineID, CASE WHEN (SearchEngineID = 0 AND AdvEngineID = 0) THEN Referer ELSE '' END AS Src, URL AS Dst, COUNT(*) AS PageViews FROM hits WHERE CounterID = 62 AND EventDate >= '2013-07-01' AND EventDate <= '2013-07-31' AND IsRefresh = 0 GROUP BY TraficSourceID, SearchEngineID, AdvEngineID, CASE WHEN (SearchEngineID = 0 AND AdvEngineID = 0) THEN Referer ELSE '' END, URL ORDER BY PageViews DESC OFFSET 1000 ROWS FETCH NEXT 10 ROWS ONLY /*LIMIT 10 OFFSET 1000*/ OPTION (LABEL = 'Query 40'); -- Replaced LIMIT 10 OFFSET 1000 with OFFSET 1000 ROWS FETCH NEXT 10 ROWS ONLY, Replaced src in the GROUP BY clause with the expression CASE WHEN (SearchEngineID = 0 AND AdvEngineID = 0) THEN Referer ELSE '' END, Replaced dst in the GROUP BY clause with URL
SELECT URLHash, EventDate, COUNT(*) AS PageViews FROM hits WHERE CounterID = 62 AND EventDate >= '2013-07-01' AND EventDate <= '2013-07-31' AND IsRefresh = 0 AND TraficSourceID IN (-1, 6) AND RefererHash = 3594120000172545465 GROUP BY URLHash, EventDate ORDER BY PageViews DESC OFFSET 100 ROWS FETCH NEXT 10 ROWS ONLY /*LIMIT 10 OFFSET 100*/ OPTION (LABEL = 'Query 41'); -- Replaced LIMIT 10 OFFSET 100 with OFFSET 100 ROWS FETCH NEXT 10 ROWS ONLY
SELECT WindowClientWidth, WindowClientHeight, COUNT(*) AS PageViews FROM hits WHERE CounterID = 62 AND EventDate >= '2013-07-01' AND EventDate <= '2013-07-31' AND IsRefresh = 0 AND DontCountHits = 0 AND URLHash = 2868770270353813622 GROUP BY WindowClientWidth, WindowClientHeight ORDER BY PageViews DESC OFFSET 10000 ROWS FETCH NEXT 10 ROWS ONLY /*LIMIT 10 OFFSET 10000*/ OPTION (LABEL = 'Query 42'); -- Replaced LIMIT 10 OFFSET 10000 with OFFSET 10000 ROWS FETCH NEXT 10 ROWS ONLY
SELECT DATETRUNC(minute, EventTime) AS M, COUNT(*) AS PageViews FROM hits WHERE CounterID = 62 AND EventDate >= '2013-07-14' AND EventDate <= '2013-07-15' AND IsRefresh = 0 AND DontCountHits = 0 GROUP BY DATETRUNC(minute, EventTime) ORDER BY DATETRUNC(minute, EventTime) OFFSET 1000 ROWS FETCH NEXT 10 ROWS ONLY /*LIMIT 10 OFFSET 1000*/ OPTION (LABEL = 'Query 43'); -- Replaced LIMIT 10 OFFSET 1000 with OFFSET 1000 ROWS FETCH NEXT 10 ROWS ONLY, Replaced DATE_TRUNC('minute', EventTime) with DATETRUNC(minute, EventTime)